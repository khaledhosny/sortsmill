# -*- coding: utf-8 -*-

m4_defun([check_linalg],
[
AT_SETUP([$1])
AT_KEYWORDS([linalg auxiliary unit])
AT_SKIP_IF([test x${DOING_INSTALLCHECK} = xyes])
AT_CHECK_UNQUOTED(["${abs_builddir}"/$1],[$2],[$3],[$4])
AT_CLEANUP
])

m4_defun([check_linalg_py],
[
AT_SETUP([$1])
AT_KEYWORDS([linalg python unit])
AT_CHECK_UNQUOTED([${PYTHON} "${abs_srcdir}"/$1],[$2],[$3],[$4])
AT_CLEANUP
])

#--------------------------------------------------------------------------

check_linalg([test_mpz_matrix_set_all 1 1 5],[0],[ 5 |],[])
check_linalg([test_mpz_matrix_set_all 2 3 -15],[0],[ -15 -15 -15 | -15 -15 -15 |],[])
#check_linalg_py([test_python_mpz_matrix_set_all.py 1 1 5],[0],[ 5 |],[])
#check_linalg_py([test_python_mpz_matrix_set_all.py 2 3 -15],[0],[ -15 -15 -15 | -15 -15 -15 |],[])

check_linalg([test_mpq_matrix_set_all 1 1 100/200],[0],[ 1/2 |],[])
check_linalg([test_mpq_matrix_set_all 2 3 -14/4],[0],[ -7/2 -7/2 -7/2 | -7/2 -7/2 -7/2 |],[])
#check_linalg_py([test_python_mpq_matrix_set_all.py 1 1 100/200],[0],[ 1/2 |],[])
#check_linalg_py([test_python_mpq_matrix_set_all.py 2 3 -14/4],[0],[ -7/2 -7/2 -7/2 | -7/2 -7/2 -7/2 |],[])

#--------------------------------------------------------------------------

check_linalg([test_mpz_matrix_set_zero 1 1],[0],[ 0 |],[])
check_linalg([test_mpz_matrix_set_zero 2 3],[0],[ 0 0 0 | 0 0 0 |],[])
#check_linalg_py([test_python_mpz_matrix_set_zero.py 1 1],[0],[ 0 |],[])
#check_linalg_py([test_python_mpz_matrix_set_zero.py 2 3],[0],[ 0 0 0 | 0 0 0 |],[])

check_linalg([test_mpq_matrix_set_zero 1 1],[0],[ 0 |],[])
check_linalg([test_mpq_matrix_set_zero 2 3],[0],[ 0 0 0 | 0 0 0 |],[])
#check_linalg_py([test_python_mpq_matrix_set_zero.py 1 1],[0],[ 0 |],[])
#check_linalg_py([test_python_mpq_matrix_set_zero.py 2 3],[0],[ 0 0 0 | 0 0 0 |],[])

#--------------------------------------------------------------------------

check_linalg([test_mpz_matrix_set_identity 1 1],[0],[ 1 |],[])
check_linalg([test_mpz_matrix_set_identity 2 3],[0],[ 1 0 0 | 0 1 0 |],[])
check_linalg([test_mpz_matrix_set_identity 3 2],[0],[ 1 0 | 0 1 | 0 0 |],[])
check_linalg([test_mpz_matrix_set_identity 3 3],[0],[ 1 0 0 | 0 1 0 | 0 0 1 |],[])
#check_linalg_py([test_python_mpz_matrix_set_identity.py 1 1],[0],[ 1 |],[])
#check_linalg_py([test_python_mpz_matrix_set_identity.py 2 3],[0],[ 1 0 0 | 0 1 0 |],[])
#check_linalg_py([test_python_mpz_matrix_set_identity.py 3 2],[0],[ 1 0 | 0 1 | 0 0 |],[])
#check_linalg_py([test_python_mpz_matrix_set_identity.py 3 3],[0],[ 1 0 0 | 0 1 0 | 0 0 1 |],[])

check_linalg([test_mpq_matrix_set_identity 1 1],[0],[ 1 |],[])
check_linalg([test_mpq_matrix_set_identity 2 3],[0],[ 1 0 0 | 0 1 0 |],[])
check_linalg([test_mpq_matrix_set_identity 3 2],[0],[ 1 0 | 0 1 | 0 0 |],[])
check_linalg([test_mpq_matrix_set_identity 3 3],[0],[ 1 0 0 | 0 1 0 | 0 0 1 |],[])
#check_linalg_py([test_python_mpq_matrix_set_identity.py 1 1],[0],[ 1 |],[])
#check_linalg_py([test_python_mpq_matrix_set_identity.py 2 3],[0],[ 1 0 0 | 0 1 0 |],[])
#check_linalg_py([test_python_mpq_matrix_set_identity.py 3 2],[0],[ 1 0 | 0 1 | 0 0 |],[])
#check_linalg_py([test_python_mpq_matrix_set_identity.py 3 3],[0],[ 1 0 0 | 0 1 0 | 0 0 1 |],[])

#--------------------------------------------------------------------------

check_linalg([test_mpz_matrix_memcpy 1 1 123246],[0],[ 123246 |],[])
check_linalg([test_mpz_matrix_memcpy 3 2 1 2 3 4 5 6],[0],[ 1 2 | 3 4 | 5 6 |],[])
check_linalg([test_mpz_matrix_memcpy 2 3 1 2 3 4 5 6],[0],[ 1 2 3 | 4 5 6 |],[])

check_linalg([test_mpq_matrix_memcpy 1 1 123/246],[0],[ 1/2 |],[])
check_linalg([test_mpq_matrix_memcpy 3 2 1 2 3 4 5 6],[0],[ 1 2 | 3 4 | 5 6 |],[])
check_linalg([test_mpq_matrix_memcpy 2 3 1 2 3 4 5 6],[0],[ 1 2 3 | 4 5 6 |],[])

#--------------------------------------------------------------------------

check_linalg([test_mpz_matrix_swap 1 1 123246 642321],[0],[ 642321 | <-> | 123246 |],[])
check_linalg([test_mpz_matrix_swap 3 2 1 2 3 4 5 6 7 8 9 10 11 12],[0],[ 7 8 | 9 10 | 11 12 | <-> | 1 2 | 3 4 | 5 6 |],[])
check_linalg([test_mpz_matrix_swap 2 3 1 2 3 4 5 6 7 8 9 10 11 12],[0],[ 7 8 9 | 10 11 12 | <-> | 1 2 3 | 4 5 6 |],[])

check_linalg([test_mpq_matrix_swap 1 1 123/246 642/321],[0],[ 2 | <-> | 1/2 |],[])
check_linalg([test_mpq_matrix_swap 3 2 1 2 3 4 5 6 7 8 9 10 11 12],[0],[ 7 8 | 9 10 | 11 12 | <-> | 1 2 | 3 4 | 5 6 |],[])
check_linalg([test_mpq_matrix_swap 2 3 1 2 3 4 5 6 7 8 9 10 11 12],[0],[ 7 8 9 | 10 11 12 | <-> | 1 2 3 | 4 5 6 |],[])

#--------------------------------------------------------------------------

check_linalg([test_mpz_matrix_swap_rows 1 1 0 0 123246],[0],[ 123246 |],[])
check_linalg([test_mpz_matrix_swap_rows 2 3 0 0 1 2 3 4 5 6],[0],[ 1 2 3 | 4 5 6 |],[])
check_linalg([test_mpz_matrix_swap_rows 2 3 1 1 1 2 3 4 5 6],[0],[ 1 2 3 | 4 5 6 |],[])
check_linalg([test_mpz_matrix_swap_rows 2 3 0 1 1 2 3 4 5 6],[0],[ 4 5 6 | 1 2 3 |],[])
check_linalg([test_mpz_matrix_swap_rows 2 3 1 0 1 2 3 4 5 6],[0],[ 4 5 6 | 1 2 3 |],[])
check_linalg([test_mpz_matrix_swap_rows 3 2 0 0 1 2 3 4 5 6],[0],[ 1 2 | 3 4 | 5 6 |],[])
check_linalg([test_mpz_matrix_swap_rows 3 2 1 1 1 2 3 4 5 6],[0],[ 1 2 | 3 4 | 5 6 |],[])
check_linalg([test_mpz_matrix_swap_rows 3 2 2 2 1 2 3 4 5 6],[0],[ 1 2 | 3 4 | 5 6 |],[])
check_linalg([test_mpz_matrix_swap_rows 3 2 0 1 1 2 3 4 5 6],[0],[ 3 4 | 1 2 | 5 6 |],[])
check_linalg([test_mpz_matrix_swap_rows 3 2 0 2 1 2 3 4 5 6],[0],[ 5 6 | 3 4 | 1 2 |],[])
check_linalg([test_mpz_matrix_swap_rows 3 2 1 0 1 2 3 4 5 6],[0],[ 3 4 | 1 2 | 5 6 |],[])
check_linalg([test_mpz_matrix_swap_rows 3 2 2 0 1 2 3 4 5 6],[0],[ 5 6 | 3 4 | 1 2 |],[])
check_linalg([test_mpz_matrix_swap_rows 3 2 1 2 1 2 3 4 5 6],[0],[ 1 2 | 5 6 | 3 4 |],[])
check_linalg([test_mpz_matrix_swap_rows 3 2 2 1 1 2 3 4 5 6],[0],[ 1 2 | 5 6 | 3 4 |],[])

check_linalg([test_mpq_matrix_swap_rows 1 1 0 0 123/246],[0],[ 1/2 |],[])
check_linalg([test_mpq_matrix_swap_rows 2 3 0 0 1 2 3 4 5 6],[0],[ 1 2 3 | 4 5 6 |],[])
check_linalg([test_mpq_matrix_swap_rows 2 3 1 1 1 2 3 4 5 6],[0],[ 1 2 3 | 4 5 6 |],[])
check_linalg([test_mpq_matrix_swap_rows 2 3 0 1 1 2 3 4 5 6],[0],[ 4 5 6 | 1 2 3 |],[])
check_linalg([test_mpq_matrix_swap_rows 2 3 1 0 1 2 3 4 5 6],[0],[ 4 5 6 | 1 2 3 |],[])
check_linalg([test_mpq_matrix_swap_rows 3 2 0 0 1 2 3 4 5 6],[0],[ 1 2 | 3 4 | 5 6 |],[])
check_linalg([test_mpq_matrix_swap_rows 3 2 1 1 1 2 3 4 5 6],[0],[ 1 2 | 3 4 | 5 6 |],[])
check_linalg([test_mpq_matrix_swap_rows 3 2 2 2 1 2 3 4 5 6],[0],[ 1 2 | 3 4 | 5 6 |],[])
check_linalg([test_mpq_matrix_swap_rows 3 2 0 1 1 2 3 4 5 6],[0],[ 3 4 | 1 2 | 5 6 |],[])
check_linalg([test_mpq_matrix_swap_rows 3 2 0 2 1 2 3 4 5 6],[0],[ 5 6 | 3 4 | 1 2 |],[])
check_linalg([test_mpq_matrix_swap_rows 3 2 1 0 1 2 3 4 5 6],[0],[ 3 4 | 1 2 | 5 6 |],[])
check_linalg([test_mpq_matrix_swap_rows 3 2 2 0 1 2 3 4 5 6],[0],[ 5 6 | 3 4 | 1 2 |],[])
check_linalg([test_mpq_matrix_swap_rows 3 2 1 2 1 2 3 4 5 6],[0],[ 1 2 | 5 6 | 3 4 |],[])
check_linalg([test_mpq_matrix_swap_rows 3 2 2 1 1 2 3 4 5 6],[0],[ 1 2 | 5 6 | 3 4 |],[])

#--------------------------------------------------------------------------

check_linalg([test_mpz_matrix_swap_columns 1 1 0 0 123246],[0],[ 123246 |],[])
check_linalg([test_mpz_matrix_swap_columns 3 2 0 0 1 2 3 4 5 6],[0],[ 1 2 | 3 4 | 5 6 |],[])
check_linalg([test_mpz_matrix_swap_columns 3 2 1 1 1 2 3 4 5 6],[0],[ 1 2 | 3 4 | 5 6 |],[])
check_linalg([test_mpz_matrix_swap_columns 3 2 0 1 1 2 3 4 5 6],[0],[ 2 1 | 4 3 | 6 5 |],[])
check_linalg([test_mpz_matrix_swap_columns 3 2 1 0 1 2 3 4 5 6],[0],[ 2 1 | 4 3 | 6 5 |],[])
check_linalg([test_mpz_matrix_swap_columns 2 3 0 0 1 2 3 4 5 6],[0],[ 1 2 3 | 4 5 6 |],[])
check_linalg([test_mpz_matrix_swap_columns 2 3 1 1 1 2 3 4 5 6],[0],[ 1 2 3 | 4 5 6 |],[])
check_linalg([test_mpz_matrix_swap_columns 2 3 2 2 1 2 3 4 5 6],[0],[ 1 2 3 | 4 5 6 |],[])
check_linalg([test_mpz_matrix_swap_columns 2 3 0 1 1 2 3 4 5 6],[0],[ 2 1 3 | 5 4 6 |],[])
check_linalg([test_mpz_matrix_swap_columns 2 3 0 2 1 2 3 4 5 6],[0],[ 3 2 1 | 6 5 4 |],[])
check_linalg([test_mpz_matrix_swap_columns 2 3 1 0 1 2 3 4 5 6],[0],[ 2 1 3 | 5 4 6 |],[])
check_linalg([test_mpz_matrix_swap_columns 2 3 2 0 1 2 3 4 5 6],[0],[ 3 2 1 | 6 5 4 |],[])
check_linalg([test_mpz_matrix_swap_columns 2 3 1 2 1 2 3 4 5 6],[0],[ 1 3 2 | 4 6 5 |],[])
check_linalg([test_mpz_matrix_swap_columns 2 3 2 1 1 2 3 4 5 6],[0],[ 1 3 2 | 4 6 5 |],[])

check_linalg([test_mpq_matrix_swap_columns 1 1 0 0 123/246],[0],[ 1/2 |],[])
check_linalg([test_mpq_matrix_swap_columns 3 2 0 0 1 2 3 4 5 6],[0],[ 1 2 | 3 4 | 5 6 |],[])
check_linalg([test_mpq_matrix_swap_columns 3 2 1 1 1 2 3 4 5 6],[0],[ 1 2 | 3 4 | 5 6 |],[])
check_linalg([test_mpq_matrix_swap_columns 3 2 0 1 1 2 3 4 5 6],[0],[ 2 1 | 4 3 | 6 5 |],[])
check_linalg([test_mpq_matrix_swap_columns 3 2 1 0 1 2 3 4 5 6],[0],[ 2 1 | 4 3 | 6 5 |],[])
check_linalg([test_mpq_matrix_swap_columns 2 3 0 0 1 2 3 4 5 6],[0],[ 1 2 3 | 4 5 6 |],[])
check_linalg([test_mpq_matrix_swap_columns 2 3 1 1 1 2 3 4 5 6],[0],[ 1 2 3 | 4 5 6 |],[])
check_linalg([test_mpq_matrix_swap_columns 2 3 2 2 1 2 3 4 5 6],[0],[ 1 2 3 | 4 5 6 |],[])
check_linalg([test_mpq_matrix_swap_columns 2 3 0 1 1 2 3 4 5 6],[0],[ 2 1 3 | 5 4 6 |],[])
check_linalg([test_mpq_matrix_swap_columns 2 3 0 2 1 2 3 4 5 6],[0],[ 3 2 1 | 6 5 4 |],[])
check_linalg([test_mpq_matrix_swap_columns 2 3 1 0 1 2 3 4 5 6],[0],[ 2 1 3 | 5 4 6 |],[])
check_linalg([test_mpq_matrix_swap_columns 2 3 2 0 1 2 3 4 5 6],[0],[ 3 2 1 | 6 5 4 |],[])
check_linalg([test_mpq_matrix_swap_columns 2 3 1 2 1 2 3 4 5 6],[0],[ 1 3 2 | 4 6 5 |],[])
check_linalg([test_mpq_matrix_swap_columns 2 3 2 1 1 2 3 4 5 6],[0],[ 1 3 2 | 4 6 5 |],[])

#--------------------------------------------------------------------------

check_linalg([test_mpz_matrix_swap_rowcol 1 0 0 123246],[0],[ 123246 |],[])
check_linalg([test_mpz_matrix_swap_rowcol 3 0 0 1 2 3 4 5 6 7 8 9],[0],[ 1 4 7 | 2 5 6 | 3 8 9 |],[])
check_linalg([test_mpz_matrix_swap_rowcol 3 1 1 1 2 3 4 5 6 7 8 9],[0],[ 1 4 3 | 2 5 8 | 7 6 9 |],[])
check_linalg([test_mpz_matrix_swap_rowcol 3 2 2 1 2 3 4 5 6 7 8 9],[0],[ 1 2 7 | 4 5 8 | 3 6 9 |],[])
check_linalg([test_mpz_matrix_swap_rowcol 3 0 1 1 2 3 4 5 6 7 8 9],[0],[ 2 5 8 | 4 1 6 | 7 3 9 |],[])
check_linalg([test_mpz_matrix_swap_rowcol 3 0 2 1 2 3 4 5 6 7 8 9],[0],[ 3 6 9 | 4 5 2 | 7 8 1 |],[])
check_linalg([test_mpz_matrix_swap_rowcol 3 1 0 1 2 3 4 5 6 7 8 9],[0],[ 4 2 3 | 5 1 7 | 6 8 9 |],[])
check_linalg([test_mpz_matrix_swap_rowcol 3 2 0 1 2 3 4 5 6 7 8 9],[0],[ 7 2 3 | 8 5 6 | 9 4 1 |],[])
check_linalg([test_mpz_matrix_swap_rowcol 3 1 2 1 2 3 4 5 6 7 8 9],[0],[ 1 2 4 | 3 6 9 | 7 8 5 |],[])
check_linalg([test_mpz_matrix_swap_rowcol 3 2 1 1 2 3 4 5 6 7 8 9],[0],[ 1 7 3 | 4 8 6 | 2 9 5 |],[])

check_linalg([test_mpq_matrix_swap_rowcol 1 0 0 123/246],[0],[ 1/2 |],[])
check_linalg([test_mpq_matrix_swap_rowcol 3 0 0 1 2 3 4 5 6 7 8 9],[0],[ 1 4 7 | 2 5 6 | 3 8 9 |],[])
check_linalg([test_mpq_matrix_swap_rowcol 3 1 1 1 2 3 4 5 6 7 8 9],[0],[ 1 4 3 | 2 5 8 | 7 6 9 |],[])
check_linalg([test_mpq_matrix_swap_rowcol 3 2 2 1 2 3 4 5 6 7 8 9],[0],[ 1 2 7 | 4 5 8 | 3 6 9 |],[])
check_linalg([test_mpq_matrix_swap_rowcol 3 0 1 1 2 3 4 5 6 7 8 9],[0],[ 2 5 8 | 4 1 6 | 7 3 9 |],[])
check_linalg([test_mpq_matrix_swap_rowcol 3 0 2 1 2 3 4 5 6 7 8 9],[0],[ 3 6 9 | 4 5 2 | 7 8 1 |],[])
check_linalg([test_mpq_matrix_swap_rowcol 3 1 0 1 2 3 4 5 6 7 8 9],[0],[ 4 2 3 | 5 1 7 | 6 8 9 |],[])
check_linalg([test_mpq_matrix_swap_rowcol 3 2 0 1 2 3 4 5 6 7 8 9],[0],[ 7 2 3 | 8 5 6 | 9 4 1 |],[])
check_linalg([test_mpq_matrix_swap_rowcol 3 1 2 1 2 3 4 5 6 7 8 9],[0],[ 1 2 4 | 3 6 9 | 7 8 5 |],[])
check_linalg([test_mpq_matrix_swap_rowcol 3 2 1 1 2 3 4 5 6 7 8 9],[0],[ 1 7 3 | 4 8 6 | 2 9 5 |],[])

#--------------------------------------------------------------------------

check_linalg([test_mpz_matrix_transpose_memcpy 1 1 123246],[0],[ 123246 |],[])
check_linalg([test_mpz_matrix_transpose_memcpy 3 2 1 2 3 4 5 6],[0],[ 1 3 5 | 2 4 6 |],[])
check_linalg([test_mpz_matrix_transpose_memcpy 2 3 1 2 3 4 5 6],[0],[ 1 4 | 2 5 | 3 6 |],[])

check_linalg([test_mpq_matrix_transpose_memcpy 1 1 123/246],[0],[ 1/2 |],[])
check_linalg([test_mpq_matrix_transpose_memcpy 3 2 1 2 3 4 5 6],[0],[ 1 3 5 | 2 4 6 |],[])
check_linalg([test_mpq_matrix_transpose_memcpy 2 3 1 2 3 4 5 6],[0],[ 1 4 | 2 5 | 3 6 |],[])

#--------------------------------------------------------------------------

# Special case: scale by 0.
check_linalg([test_mpz_matrix_scale 1 1 0 123246],[0],[ 0 |],[])
check_linalg([test_mpz_matrix_scale 3 2 0 1 2 3 4 5 6],[0],[ 0 0 | 0 0 | 0 0 |],[])
check_linalg([test_mpz_matrix_scale 2 3 0 1 2 3 4 5 6],[0],[ 0 0 0 | 0 0 0 |],[])

# Special case: scale by 1.
check_linalg([test_mpz_matrix_scale 1 1 1 123246],[0],[ 123246 |],[])
check_linalg([test_mpz_matrix_scale 3 2 1 1 2 3 4 5 6],[0],[ 1 2 | 3 4 | 5 6 |],[])
check_linalg([test_mpz_matrix_scale 2 3 1 1 2 3 4 5 6],[0],[ 1 2 3 | 4 5 6 |],[])

# Other cases.
check_linalg([test_mpz_matrix_scale 1 1 -1 123246],[0],[ -123246 |],[])
check_linalg([test_mpz_matrix_scale 3 2 2 1 2 3 4 5 6],[0],[ 2 4 | 6 8 | 10 12 |],[])
check_linalg([test_mpz_matrix_scale 2 3 -3 1 2 3 4 5 6],[0],[ -3 -6 -9 | -12 -15 -18 |],[])

# Special case: scale by 0.
check_linalg([test_mpq_matrix_scale 1 1 0 123/246],[0],[ 0 |],[])
check_linalg([test_mpq_matrix_scale 3 2 0 1 2 3 4 5 6],[0],[ 0 0 | 0 0 | 0 0 |],[])
check_linalg([test_mpq_matrix_scale 2 3 0 1 2 3 4 5 6],[0],[ 0 0 0 | 0 0 0 |],[])

# Special case: scale by 1.
check_linalg([test_mpq_matrix_scale 1 1 1 123/246],[0],[ 1/2 |],[])
check_linalg([test_mpq_matrix_scale 3 2 1 1 2 3 4 5 6],[0],[ 1 2 | 3 4 | 5 6 |],[])
check_linalg([test_mpq_matrix_scale 2 3 1 1 2 3 4 5 6],[0],[ 1 2 3 | 4 5 6 |],[])

# Other cases.
check_linalg([test_mpq_matrix_scale 1 1 -1 123/246],[0],[ -1/2 |],[])
check_linalg([test_mpq_matrix_scale 3 2 2 1 2 3 4 5 6],[0],[ 2 4 | 6 8 | 10 12 |],[])
check_linalg([test_mpq_matrix_scale 2 3 -3 1 2 3 4 5 6],[0],[ -3 -6 -9 | -12 -15 -18 |],[])

#--------------------------------------------------------------------------

# alpha = beta = 0.
check_linalg([test_mpz_matrix_gemm 0 0 2 1 2 0 0 1 2 3 4 5 6 100 200],[0],[ 0 | 0 |],[])

# alpha = 0, beta = 1.
check_linalg([test_mpz_matrix_gemm 0 0 2 1 2 0 1 1 2 3 4 5 6 100 200],[0],[ 100 | 200 |],[])

# alpha = 0, beta = -2.
check_linalg([test_mpz_matrix_gemm 0 0 2 1 2 0 -2 1 2 3 4 5 6 100 200],[0],[ -200 | -400 |],[])

# alpha = 1, beta = 0.
check_linalg([test_mpz_matrix_gemm 0 0 2 2 3 1 0 1 2 3 4 5 6 7 8 9 10 11 12 100 200 300 400],[0],[ 58 64 | 139 154 |],[])
check_linalg([test_mpz_matrix_gemm 1 0 2 2 3 1 0 1 4 2 5 3 6 7 8 9 10 11 12 100 200 300 400],[0],[ 58 64 | 139 154 |],[])
check_linalg([test_mpz_matrix_gemm 0 1 2 2 3 1 0 1 2 3 4 5 6 7 9 11 8 10 12 100 200 300 400],[0],[ 58 64 | 139 154 |],[])
check_linalg([test_mpz_matrix_gemm 1 1 2 2 3 1 0 1 4 2 5 3 6 7 9 11 8 10 12 100 200 300 400],[0],[ 58 64 | 139 154 |],[])

# alpha = 1, beta = 1.
check_linalg([test_mpz_matrix_gemm 0 0 2 2 3 1 1 1 2 3 4 5 6 7 8 9 10 11 12 100 200 300 400],[0],[ 158 264 | 439 554 |],[])
check_linalg([test_mpz_matrix_gemm 1 0 2 2 3 1 1 1 4 2 5 3 6 7 8 9 10 11 12 100 200 300 400],[0],[ 158 264 | 439 554 |],[])
check_linalg([test_mpz_matrix_gemm 0 1 2 2 3 1 1 1 2 3 4 5 6 7 9 11 8 10 12 100 200 300 400],[0],[ 158 264 | 439 554 |],[])
check_linalg([test_mpz_matrix_gemm 1 1 2 2 3 1 1 1 4 2 5 3 6 7 9 11 8 10 12 100 200 300 400],[0],[ 158 264 | 439 554 |],[])

# alpha = 1, beta = -2.
check_linalg([test_mpz_matrix_gemm 0 0 2 2 3 1 -2 1 2 3 4 5 6 7 8 9 10 11 12 100 200 300 400],[0],[ -142 -336 | -461 -646 |],[])
check_linalg([test_mpz_matrix_gemm 1 0 2 2 3 1 -2 1 4 2 5 3 6 7 8 9 10 11 12 100 200 300 400],[0],[ -142 -336 | -461 -646 |],[])
check_linalg([test_mpz_matrix_gemm 0 1 2 2 3 1 -2 1 2 3 4 5 6 7 9 11 8 10 12 100 200 300 400],[0],[ -142 -336 | -461 -646 |],[])
check_linalg([test_mpz_matrix_gemm 1 1 2 2 3 1 -2 1 4 2 5 3 6 7 9 11 8 10 12 100 200 300 400],[0],[ -142 -336 | -461 -646 |],[])

# alpha = 5, beta = 0.
check_linalg([test_mpz_matrix_gemm 0 0 2 2 3 5 0 1 2 3 4 5 6 7 8 9 10 11 12 100 200 300 400],[0],[ 290 320 | 695 770 |],[])
check_linalg([test_mpz_matrix_gemm 1 0 2 2 3 5 0 1 4 2 5 3 6 7 8 9 10 11 12 100 200 300 400],[0],[ 290 320 | 695 770 |],[])
check_linalg([test_mpz_matrix_gemm 0 1 2 2 3 5 0 1 2 3 4 5 6 7 9 11 8 10 12 100 200 300 400],[0],[ 290 320 | 695 770 |],[])
check_linalg([test_mpz_matrix_gemm 1 1 2 2 3 5 0 1 4 2 5 3 6 7 9 11 8 10 12 100 200 300 400],[0],[ 290 320 | 695 770 |],[])

# alpha = 5, beta = 1.
check_linalg([test_mpz_matrix_gemm 0 0 2 2 3 5 1 1 2 3 4 5 6 7 8 9 10 11 12 100 200 300 400],[0],[ 390 520 | 995 1170 |],[])
check_linalg([test_mpz_matrix_gemm 1 0 2 2 3 5 1 1 4 2 5 3 6 7 8 9 10 11 12 100 200 300 400],[0],[ 390 520 | 995 1170 |],[])
check_linalg([test_mpz_matrix_gemm 0 1 2 2 3 5 1 1 2 3 4 5 6 7 9 11 8 10 12 100 200 300 400],[0],[ 390 520 | 995 1170 |],[])
check_linalg([test_mpz_matrix_gemm 1 1 2 2 3 5 1 1 4 2 5 3 6 7 9 11 8 10 12 100 200 300 400],[0],[ 390 520 | 995 1170 |],[])

# alpha = 5, beta = -2.
check_linalg([test_mpz_matrix_gemm 0 0 2 2 3 5 -2 1 2 3 4 5 6 7 8 9 10 11 12 100 200 300 400],[0],[ 90 -80 | 95 -30 |],[])
check_linalg([test_mpz_matrix_gemm 1 0 2 2 3 5 -2 1 4 2 5 3 6 7 8 9 10 11 12 100 200 300 400],[0],[ 90 -80 | 95 -30 |],[])
check_linalg([test_mpz_matrix_gemm 0 1 2 2 3 5 -2 1 2 3 4 5 6 7 9 11 8 10 12 100 200 300 400],[0],[ 90 -80 | 95 -30 |],[])
check_linalg([test_mpz_matrix_gemm 1 1 2 2 3 5 -2 1 4 2 5 3 6 7 9 11 8 10 12 100 200 300 400],[0],[ 90 -80 | 95 -30 |],[])

# alpha = beta = 0.
check_linalg([test_mpq_matrix_gemm 0 0 2 1 2 0 0 1 2 3 4 5 6 100 200],[0],[ 0 | 0 |],[])

# alpha = 0, beta = 1.
check_linalg([test_mpq_matrix_gemm 0 0 2 1 2 0 1 1 2 3 4 5 6 100 200],[0],[ 100 | 200 |],[])

# alpha = 0, beta = -1/2.
check_linalg([test_mpq_matrix_gemm 0 0 2 1 2 0 -1/2 1 2 3 4 5 6 100 200],[0],[ -50 | -100 |],[])

# alpha = 1, beta = 0.
check_linalg([test_mpq_matrix_gemm 0 0 2 2 3 1 0 1 2 3 4 5 6 7 8 9 10 11 12 100 200 300 400],[0],[ 58 64 | 139 154 |],[])
check_linalg([test_mpq_matrix_gemm 1 0 2 2 3 1 0 1 4 2 5 3 6 7 8 9 10 11 12 100 200 300 400],[0],[ 58 64 | 139 154 |],[])
check_linalg([test_mpq_matrix_gemm 0 1 2 2 3 1 0 1 2 3 4 5 6 7 9 11 8 10 12 100 200 300 400],[0],[ 58 64 | 139 154 |],[])
check_linalg([test_mpq_matrix_gemm 1 1 2 2 3 1 0 1 4 2 5 3 6 7 9 11 8 10 12 100 200 300 400],[0],[ 58 64 | 139 154 |],[])

# alpha = 1, beta = 1.
check_linalg([test_mpq_matrix_gemm 0 0 2 2 3 1 1 1 2 3 4 5 6 7 8 9 10 11 12 100 200 300 400],[0],[ 158 264 | 439 554 |],[])
check_linalg([test_mpq_matrix_gemm 1 0 2 2 3 1 1 1 4 2 5 3 6 7 8 9 10 11 12 100 200 300 400],[0],[ 158 264 | 439 554 |],[])
check_linalg([test_mpq_matrix_gemm 0 1 2 2 3 1 1 1 2 3 4 5 6 7 9 11 8 10 12 100 200 300 400],[0],[ 158 264 | 439 554 |],[])
check_linalg([test_mpq_matrix_gemm 1 1 2 2 3 1 1 1 4 2 5 3 6 7 9 11 8 10 12 100 200 300 400],[0],[ 158 264 | 439 554 |],[])

# alpha = 1, beta = -1/2.
check_linalg([test_mpq_matrix_gemm 0 0 2 2 3 1 -1/2 1 2 3 4 5 6 7 8 9 10 11 12 100 200 300 400],[0],[ 8 -36 | -11 -46 |],[])
check_linalg([test_mpq_matrix_gemm 1 0 2 2 3 1 -1/2 1 4 2 5 3 6 7 8 9 10 11 12 100 200 300 400],[0],[ 8 -36 | -11 -46 |],[])
check_linalg([test_mpq_matrix_gemm 0 1 2 2 3 1 -1/2 1 2 3 4 5 6 7 9 11 8 10 12 100 200 300 400],[0],[ 8 -36 | -11 -46 |],[])
check_linalg([test_mpq_matrix_gemm 1 1 2 2 3 1 -1/2 1 4 2 5 3 6 7 9 11 8 10 12 100 200 300 400],[0],[ 8 -36 | -11 -46 |],[])

# alpha = 5, beta = 0.
check_linalg([test_mpq_matrix_gemm 0 0 2 2 3 5 0 1 2 3 4 5 6 7 8 9 10 11 12 100 200 300 400],[0],[ 290 320 | 695 770 |],[])
check_linalg([test_mpq_matrix_gemm 1 0 2 2 3 5 0 1 4 2 5 3 6 7 8 9 10 11 12 100 200 300 400],[0],[ 290 320 | 695 770 |],[])
check_linalg([test_mpq_matrix_gemm 0 1 2 2 3 5 0 1 2 3 4 5 6 7 9 11 8 10 12 100 200 300 400],[0],[ 290 320 | 695 770 |],[])
check_linalg([test_mpq_matrix_gemm 1 1 2 2 3 5 0 1 4 2 5 3 6 7 9 11 8 10 12 100 200 300 400],[0],[ 290 320 | 695 770 |],[])

# alpha = 5, beta = 1.
check_linalg([test_mpq_matrix_gemm 0 0 2 2 3 5 1 1 2 3 4 5 6 7 8 9 10 11 12 100 200 300 400],[0],[ 390 520 | 995 1170 |],[])
check_linalg([test_mpq_matrix_gemm 1 0 2 2 3 5 1 1 4 2 5 3 6 7 8 9 10 11 12 100 200 300 400],[0],[ 390 520 | 995 1170 |],[])
check_linalg([test_mpq_matrix_gemm 0 1 2 2 3 5 1 1 2 3 4 5 6 7 9 11 8 10 12 100 200 300 400],[0],[ 390 520 | 995 1170 |],[])
check_linalg([test_mpq_matrix_gemm 1 1 2 2 3 5 1 1 4 2 5 3 6 7 9 11 8 10 12 100 200 300 400],[0],[ 390 520 | 995 1170 |],[])

# alpha = 5, beta = -1/2.
check_linalg([test_mpq_matrix_gemm 0 0 2 2 3 5 -1/2 1 2 3 4 5 6 7 8 9 10 11 12 100 200 300 400],[0],[ 240 220 | 545 570 |],[])
check_linalg([test_mpq_matrix_gemm 1 0 2 2 3 5 -1/2 1 4 2 5 3 6 7 8 9 10 11 12 100 200 300 400],[0],[ 240 220 | 545 570 |],[])
check_linalg([test_mpq_matrix_gemm 0 1 2 2 3 5 -1/2 1 2 3 4 5 6 7 9 11 8 10 12 100 200 300 400],[0],[ 240 220 | 545 570 |],[])
check_linalg([test_mpq_matrix_gemm 1 1 2 2 3 5 -1/2 1 4 2 5 3 6 7 9 11 8 10 12 100 200 300 400],[0],[ 240 220 | 545 570 |],[])

#--------------------------------------------------------------------------
