m4_defun([check_bernstein],
[
AT_SETUP([$2])
AT_KEYWORDS([auxiliary scheme guile python polyspline bernstein unit spline])
AT_SKIP_IF([test x$1 = xskip -a x${DOING_INSTALLCHECK} = xyes])
AT_CHECK_UNQUOTED([
export LC_ALL="${posix_locale}"
export LTDL_LIBRARY_PATH="${abs_top_builddir}/scheme"
export GUILE_LOAD_PATH="${abs_top_srcdir}/scheme"
$3],
[$4],[$5],[$6])
AT_CLEANUP
])

m4_define([big_check],
[
check_bernstein([$1],[$2],[$3],[0],
[eval_sbern_double
5.000000|5.000000|5.000000|5.000000|5.000000|
5.000000|4.750000|4.500000|4.250000|4.000000|
5.000000|3.375000|1.500000|-0.625000|-3.000000|
5.000000|2.562500|1.000000|0.687500|2.000000|
5.000000|1.925781|0.562500|0.488281|1.000000|
5.000000|1.444336|0.281250|0.122070|0.000000|
5.000000|1.083496|0.156250|0.208496|1.000000|
5.000000|0.812500|0.062500|-0.214844|-2.000000|
5.000000|0.609421|0.042969|0.246628|3.000000|
5.000000|0.457081|0.029297|0.361996|4.000000|
5.000000|0.342815|0.019531|0.372066|5.000000|
eval_bern_double
5.000000|5.000000|5.000000|5.000000|5.000000|
5.000000|4.750000|4.500000|4.250000|4.000000|
5.000000|4.125000|2.500000|0.125000|-3.000000|
5.000000|3.406250|1.250000|0.218750|2.000000|
5.000000|2.734375|0.750000|0.734375|1.000000|
5.000000|2.167969|0.625000|0.722656|0.000000|
5.000000|1.720703|0.625000|0.658203|1.000000|
5.000000|1.383789|0.625000|0.303711|-2.000000|
5.000000|1.139008|0.585938|0.200531|3.000000|
5.000000|0.965919|0.527344|0.661980|4.000000|
5.000000|0.845594|0.498047|1.543913|5.000000|
evaldc_sbern_double
5.000000|5.000000|5.000000|5.000000|5.000000|
5.000000|4.750000|4.500000|4.250000|4.000000|
5.000000|3.375000|1.500000|-0.625000|-3.000000|
5.000000|2.562500|1.000000|0.687500|2.000000|
5.000000|1.925781|0.562500|0.488281|1.000000|
5.000000|1.444336|0.281250|0.122070|0.000000|
5.000000|1.083496|0.156250|0.208496|1.000000|
5.000000|0.812500|0.062500|-0.214844|-2.000000|
5.000000|0.609421|0.042969|0.246628|3.000000|
5.000000|0.457081|0.029297|0.361996|4.000000|
5.000000|0.342815|0.019531|0.372066|5.000000|
evaldc_bern_double
5.000000|5.000000|5.000000|5.000000|5.000000|
5.000000|4.750000|4.500000|4.250000|4.000000|
5.000000|4.125000|2.500000|0.125000|-3.000000|
5.000000|3.406250|1.250000|0.218750|2.000000|
5.000000|2.734375|0.750000|0.734375|1.000000|
5.000000|2.167969|0.625000|0.722656|0.000000|
5.000000|1.720703|0.625000|0.658203|1.000000|
5.000000|1.383789|0.625000|0.303711|-2.000000|
5.000000|1.139008|0.585938|0.200531|3.000000|
5.000000|0.965919|0.527344|0.661980|4.000000|
5.000000|0.845594|0.498047|1.543913|5.000000|
subdiv_sbern_double
t=0.000000|5.000000|5.000000|
t=0.250000|5.000000|5.000000|
t=0.500000|5.000000|5.000000|
t=0.750000|5.000000|5.000000|
t=1.000000|5.000000|5.000000|
t=0.000000|5.000000|5.000000|5.000000|4.000000|
t=0.250000|5.000000|4.750000|4.750000|4.000000|
t=0.500000|5.000000|4.500000|4.500000|4.000000|
t=0.750000|5.000000|4.250000|4.250000|4.000000|
t=1.000000|5.000000|4.000000|4.000000|4.000000|
t=0.000000|5.000000|10.000000|5.000000|5.000000|4.000000|-3.000000|
t=0.250000|5.000000|8.500000|3.375000|3.375000|-0.375000|-3.000000|
t=0.500000|5.000000|7.000000|1.500000|1.500000|-3.500000|-3.000000|
t=0.750000|5.000000|5.500000|-0.625000|-0.625000|-5.375000|-3.000000|
t=1.000000|5.000000|4.000000|-3.000000|-3.000000|-6.000000|-3.000000|
t=0.000000|5.000000|15.000000|15.000000|5.000000|5.000000|4.000000|-3.000000|2.000000|
t=0.250000|5.000000|12.250000|9.750000|2.562500|2.562500|1.359375|2.203125|2.000000|
t=0.500000|5.000000|9.500000|5.000000|1.000000|1.000000|2.375000|4.875000|2.000000|
t=0.750000|5.000000|6.750000|0.750000|0.687500|0.687500|4.703125|5.859375|2.000000|
t=1.000000|5.000000|4.000000|-3.000000|2.000000|2.000000|6.000000|6.000000|2.000000|
t=0.000000|5.000000|20.000000|30.000000|20.000000|5.000000|5.000000|4.000000|-3.000000|2.000000|1.000000|
t=0.250000|5.000000|16.000000|18.937500|9.875000|1.925781|1.925781|1.046875|1.886719|3.367188|1.000000|
t=0.500000|5.000000|12.000000|9.750000|3.500000|0.562500|0.562500|1.750000|4.687500|3.875000|1.000000|
t=0.750000|5.000000|8.000000|2.437500|0.875000|0.488281|0.488281|3.296875|5.824219|3.992188|1.000000|
t=1.000000|5.000000|4.000000|-3.000000|2.000000|1.000000|1.000000|4.000000|6.000000|4.000000|1.000000|
subdiv_bern_double
t=0.000000|5.000000|5.000000|1
t=0.250000|5.000000|5.000000|1
t=0.500000|5.000000|5.000000|1
t=0.750000|5.000000|5.000000|1
t=1.000000|5.000000|5.000000|1
t=0.000000|5.000000|5.000000|5.000000|4.000000|1
t=0.250000|5.000000|4.750000|4.750000|4.000000|1
t=0.500000|5.000000|4.500000|4.500000|4.000000|1
t=0.750000|5.000000|4.250000|4.250000|4.000000|1
t=1.000000|5.000000|4.000000|4.000000|4.000000|1
t=0.000000|5.000000|5.000000|5.000000|5.000000|4.000000|-3.000000|1
t=0.250000|5.000000|4.750000|4.125000|4.125000|0.937500|-3.000000|1
t=0.500000|5.000000|4.500000|2.500000|2.500000|-1.250000|-3.000000|1
t=0.750000|5.000000|4.250000|0.125000|0.125000|-2.562500|-3.000000|1
t=1.000000|5.000000|4.000000|-3.000000|-3.000000|-3.000000|-3.000000|1
t=0.000000|5.000000|5.000000|5.000000|5.000000|5.000000|4.000000|-3.000000|2.000000|1
t=0.250000|5.000000|4.750000|4.125000|3.406250|3.406250|0.734375|-0.109375|2.000000|1
t=0.500000|5.000000|4.500000|2.500000|1.250000|1.250000|0.375000|1.375000|2.000000|1
t=0.750000|5.000000|4.250000|0.125000|0.218750|0.218750|1.328125|1.921875|2.000000|1
t=1.000000|5.000000|4.000000|-3.000000|2.000000|2.000000|2.000000|2.000000|2.000000|1
t=0.000000|5.000000|5.000000|5.000000|5.000000|5.000000|5.000000|4.000000|-3.000000|2.000000|1.000000|1
t=0.250000|5.000000|4.750000|4.125000|3.406250|2.734375|2.734375|0.472656|0.156250|1.316406|1.000000|1
t=0.500000|5.000000|4.500000|2.500000|1.250000|0.750000|0.750000|0.562500|1.000000|1.062500|1.000000|1
t=0.750000|5.000000|4.250000|0.125000|0.218750|0.734375|0.734375|1.035156|1.031250|1.003906|1.000000|1
t=1.000000|5.000000|4.000000|-3.000000|2.000000|1.000000|1.000000|1.000000|1.000000|1.000000|1.000000|1
],
[])
])

big_check([skip],[test_bernstein],["${abs_builddir}"/test_bernstein])
big_check([],[test_guile_bernstein.scm],[${run_guile} "${abs_srcdir}"/test_guile_bernstein.scm])
big_check([],[test_python_bernstein.py],[${PYTHON} "${abs_srcdir}"/test_python_bernstein.py])
